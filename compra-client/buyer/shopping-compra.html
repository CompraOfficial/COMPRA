<!DOCTYPE html>

<html data-wf-page="62da9e4a5e4a277cd62f00e2" data-wf-site="62da9e495e4a27647f2f00aa" lang="en">
<head>
  <meta charset="utf-8">
  <title>Shopping | COMPRA</title>
  <meta content="Startup Template - compra Responsive Website Template" name="description">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="compra" name="generator">
  <link href="../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../css/compra.css" rel="stylesheet" type="text/css">
  <link href="../css/compra-client.compra.css" rel="stylesheet" type="text/css">
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../images/favicon.jpg" rel="shortcut icon" type="image/x-icon">
  <link href="../images/webclip.jpg" rel="apple-touch-icon">
  
  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="../js/gen_function.js"></script>

  <!-- Local Routing -->
  <script src="../js/local_routes.js"></script>
  <script>
    $(document).ready(function(){
      var dataForm = new FormData();
      var xhr = new XMLHttpRequest();
      xhr.open("POST", BUYER_API.SHOP_PRODUCTS);
      xhr.onload = function(){
        var result = JSON.parse(this.response)

        for (const product of result) {
          if(product.status != "DELETED"){
            $('.shop-output').append(
              '<div id="w-node-_2d68654d-7116-e9b3-3bdc-92ffb95a3979-d62f00e2" class="product-box">' +
                '<div class="product-img-wrapper" style="border-radius: 10px; overflow: hidden; margin-bottom: .5rem;">' +
                  '<img src="http://localhost/compra/compra-backend/api/trader/uploads/products/'+product.img1+'" loading="lazy" alt="" class="image stretch-flow product">' +
                '</div>' +
                '<div >' +
                  '<h3 class="h3 home text-black name" style="margin-bottom: 0px;">'+product.product_name+'</h3>' +
                  '<h4 class="h4 coconut-type">₱'+product.price+' per '+product.unit_measurement+'<br/>'+product.category+'</h4>' +
                  '<p class="text-gray">' +
                    'by <strong>' + product.company + '</strong><br>' +
                    'Type: ' + product.product_type + '<br>' +
                    'Moisture: ' + product.moisture + '<br>' +
                    'Age: ' + product.age + '<br>' +
                    'Available stocks: ' + product.stock + '<br>' +
                    'Location: ' + product.address.split(', ')[2] + '<br>' +
                  '</p>' +
                  '<div class="content-hbetween">' +
                    '<a href="#" id="pid-'+product.id+'" class="button style2 w-button favorite"><span class="fa-icon"></span></a>' +
                    '<div class="p-0-5"></div>' +
                    '<a href="product-compra.html?pId='+product.id+'" class="button flex-strech w-button">View Product</a>' +
                  '</div>' +
                '</div>' +
              '</div>'
            ); 
          }    
        }
        $('.favorite').click(function(){
          var dataForm = new FormData();
          var pId = this.id.split('-')[1];

          dataForm.append("pId", pId);
          dataForm.append("bId", window.localStorage.getItem('user_id'));

          var xhr = new XMLHttpRequest();
          xhr.open("POST", BUYER_API.ADD_FAV_PRODUCT);
          xhr.onload = function(){
            console.log(this.response)
            if(this.response == "Successfully Added as Favorite"){
              alert(this.response);
            }else if (confirm('This product is already added to the favorite. Do you want to remove this on your favorites?')) {
              var dataForm = new FormData();

              dataForm.append("pId", pId);
              dataForm.append("bId", window.localStorage.getItem('user_id'));

              var xhr = new XMLHttpRequest();
              xhr.open("POST", BUYER_API.REMOVE_FAV_PRODUCT);
              xhr.onload = function(){
                console.log(this.response)
                alert(this.response)
              }
              xhr.send(dataForm);
              
            }
          }
          xhr.send(dataForm); 
        })

      }
      xhr.send(dataForm); 
    })
  </script>
</head>
<body>
  <!-- navbae -->
  <div class="navbar abs-top non-home">
    <div class="container">
      <div class="nav-content">
        <div class="nav-left-content"><img src="../images/noname123.png" loading="lazy" alt="" class="nav-logo">
          <a href="../buyer/buyer-home-compra.html" class="nav-link">Home</a>
          <a href="../buyer/shopping-compra.html" aria-current="page" class="nav-link w--current">Shop</a>
          <a href="../buyer/favorites-compra.html" class="nav-link">Favorites</a>
          <a href="../buyer/bidding-compra.html" class="nav-link">Bidding</a>
          <a href="../buyer/subscription-compra.html" class="nav-link">Subscription</a>
        </div>
        <div class="nav-right-content">
          <a href="../buyer/notification-compra.html" class="nav-link fa-icon"></a>
          <a href="../buyer/cart-compra.html" class="nav-link fa-icon"></a>
          <div data-w-id="aa70e902-2f0f-387f-8368-e2bc6663a557" class="profile-dropdown">
            <a href="#" class="nav-link mr-0 fa-icon"></a>
            <div class="dropdown-content">
              <div class="flex-v">
                <div class="setting-cat">user settings</div>
                <a href="../buyer/edit-profile-compra.html" class="content-vcenter no-dec mb-1 w-inline-block">
                  <div class="profile-pic mr-1"><img src="../images/360_F_64676383_LdbmhiNM6Ypzb3FM4PPuFP9rHe7ri8Ju.jpg" loading="lazy" alt="" class="profile-image"></div>
                  <div>
                    <div class="us-name">[Full name]</div>
                    <div class="text-gray small-text">Edit Profile Details</div>
                  </div>
                </a>
              </div>
              <a href="../buyer/chat-compra.html" class="content-vcenter mb-1 no-dec w-inline-block">
                <div class="us-icon"><img src="https://d3e54v103j8qbb.cloudfront.net/plugins/Basic/assets/placeholder.60f9b1840c.svg" loading="lazy" alt="" class="image stretch-flow"></div>
                <div><strong class="black-text">Chats</strong></div>
              </a>
              <a href="../buyer/order-history-compra.html" class="content-vcenter mb-1 no-dec w-inline-block">
                <div class="us-icon"><img src="https://d3e54v103j8qbb.cloudfront.net/plugins/Basic/assets/placeholder.60f9b1840c.svg" loading="lazy" alt="" class="image stretch-flow"></div>
                <div><strong class="black-text">Order History</strong></div>
              </a>
              <a href="../buyer/edit-shipping-info-compra.html" class="content-vcenter mb-1 no-dec w-inline-block">
                <div class="us-icon"><img src="https://d3e54v103j8qbb.cloudfront.net/plugins/Basic/assets/placeholder.60f9b1840c.svg" loading="lazy" alt="" class="image stretch-flow"></div>
                <div><strong class="black-text">Shipping Info</strong></div>
              </a>
              <a href="#" onclick="logout()" class="content-vcenter no-dec w-inline-block">
                <div class="us-icon"><img src="https://d3e54v103j8qbb.cloudfront.net/plugins/Basic/assets/placeholder.60f9b1840c.svg" loading="lazy" alt="" class="image stretch-flow"></div>
                <div><strong class="black-text">Logout</strong></div>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- main section -->
  <div class="section small">
    <div class="container">

      <h1 class="h1 gen">Shop</h1>

      <div class="grid-shop-content">
        <div id="w-node-_0c49ade0-95f0-771f-b1cf-d3559653f181-d62f00e2" class="filter-content">
          <div>

            <div class="live-wrapper">
              <h3 class="h3 shop">Live Price Update</h3>
              <div class="content-hbetween mb-1">
                <div>Now:</div>
                <div>₱ 00.00</div>
              </div>
              <div class="content-hbetween">
                <div>Before:</div>
                <div>₱ 00.00</div>
              </div>
            </div>
            
            <div class="mb-1 w-form">
              <div id="email-form" class="flex-v">
                <input type="text" id="search" class="text-field w-input" maxlength="256" placeholder="Enter text here...">
                <input type="submit" value="Search" data-wait="Please wait..." class="button w-button">
              </div>              
            </div>

            <div class="mb-1">
              <div><strong>Price</strong></div>
              <div class="grid-2">
                
              </div>
            </div>

            <div class="mb-1">
              <div><strong>Product Name</strong></div>
              <div class="grid-2"></div>
            </div>

            <div class="mb-1">
              <div><strong>Location</strong></div>
              <div class="grid-2"></div>
            </div>

          </div>
        </div>

        <div id="w-node-_61a179c7-367e-6449-27d0-5e1e51b6ff1a-d62f00e2" class="shop-output">
          <!-- product outputs -->
          
        </div>
        
        <div class="no-item shopping">
          <div class="text-gray">No Item Available</div>
        </div>

      </div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=62da9e495e4a27647f2f00aa" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../js/compra.js" type="text/javascript"></script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
</body>
</html>